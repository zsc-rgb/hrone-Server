# 📝 第3阶段准备工作

> 开始第3阶段前，需要先准备MySQL数据库

---

## ✅ 第3阶段概述

### 学习目标
- 集成MyBatis-Plus实现数据库操作
- 配置Druid数据源和监控
- 掌握CRUD操作和分页查询

### 需要准备
1. ✅ MySQL数据库（8.0+）
2. ✅ 数据库管理工具（Navicat/DataGrip/DBeaver）
3. ✅ SQL脚本已准备好

---

## 📦 步骤1：安装MySQL（如果还没安装）

### Windows系统

**方法1：使用安装包（推荐）**

1. 下载MySQL
   - 访问：https://dev.mysql.com/downloads/mysql/
   - 选择：Windows (x86, 64-bit), ZIP Archive
   
2. 安装步骤
   ```
   - 解压到：D:\MySQL
   - 运行：mysqld --initialize-insecure
   - 安装服务：mysqld --install
   - 启动服务：net start mysql
   ```

3. 设置密码
   ```bash
   mysql -u root
   ALTER USER 'root'@'localhost' IDENTIFIED BY 'root';
   ```

**方法2：使用已安装的MySQL**

如果你已经安装了MySQL，确认以下信息：
- ✅ MySQL服务正在运行
- ✅ root密码是什么（默认配置中使用 `root`）
- ✅ 端口是3306

---

## 📝 步骤2：创建数据库

### 方法1：使用命令行（推荐）

```bash
# 1. 进入MySQL
cd d:\HroneWorking\hrone-Server
mysql -u root -p

# 2. 执行SQL脚本
source sql/hrone_schema.sql

# 或者直接执行
mysql -u root -p < sql/hrone_schema.sql
```

### 方法2：使用Navicat等工具

1. 连接MySQL
   - 主机：localhost
   - 端口：3306
   - 用户名：root
   - 密码：root（或你自己设置的密码）

2. 打开SQL文件
   - 打开：`d:\HroneWorking\hrone-Server\sql\hrone_schema.sql`
   - 点击"运行"按钮

3. 验证
   - 刷新左侧数据库列表
   - 应该看到 `hrone_db` 数据库
   - 展开后看到 `sys_user` 表
   - 表中有5条测试数据

---

## ✅ 步骤3：验证数据库

### 检查数据库是否创建成功

```sql
-- 1. 查看数据库
SHOW DATABASES LIKE 'hrone_db';

-- 2. 切换数据库
USE hrone_db;

-- 3. 查看表
SHOW TABLES;

-- 4. 查看数据
SELECT * FROM sys_user;
```

**预期结果：**
- 数据库 `hrone_db` 存在
- 表 `sys_user` 存在
- 有5条测试数据

---

## ⚙️ 步骤4：修改数据库配置（如果需要）

如果你的MySQL配置不同，请修改：

**文件位置：** `hrone-admin/src/main/resources/application-dev.yml`

```yaml
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/hrone_db?...
    username: root      # 修改为你的用户名
    password: root      # 修改为你的密码
```

---

## 🧪 步骤5：测试数据库连接

### 编译项目

```bash
cd d:\HroneWorking\hrone-Server
mvn clean install -DskipTests
```

**注意：** 如果编译失败，检查：
1. MySQL是否启动
2. 数据库配置是否正确
3. 数据库是否已创建

### 启动项目

```bash
mvn spring-boot:run -pl hrone-admin
```

**启动成功标志：**
```
HikariPool-1 - Starting...
HikariPool-1 - Start completed.
```

**如果看到以上日志，说明数据库连接成功！** ✅

---

## 🔍 常见问题

### Q1: MySQL服务无法启动？

**解决：**
```bash
# Windows
net start mysql

# 如果提示服务不存在
mysqld --install
net start mysql
```

---

### Q2: 连接数据库失败？

**错误：** `Access denied for user 'root'@'localhost'`

**解决：**
1. 检查密码是否正确
2. 重置root密码

```sql
ALTER USER 'root'@'localhost' IDENTIFIED BY 'root';
FLUSH PRIVILEGES;
```

---

### Q3: 找不到数据库？

**错误：** `Unknown database 'hrone_db'`

**解决：**
```sql
CREATE DATABASE IF NOT EXISTS `hrone_db` 
DEFAULT CHARACTER SET utf8mb4 
COLLATE utf8mb4_general_ci;
```

---

### Q4: 表不存在？

**错误：** `Table 'hrone_db.sys_user' doesn't exist`

**解决：**
1. 确认数据库已切换：`USE hrone_db;`
2. 重新执行建表SQL

---

## 📊 数据库信息

### 数据库配置

| 项目 | 值 |
|------|-----|
| 数据库名 | hrone_db |
| 字符集 | utf8mb4 |
| 排序规则 | utf8mb4_general_ci |
| 表名 | sys_user |
| 测试数据 | 5条 |

### 测试数据

| user_id | user_name | nick_name | status |
|---------|-----------|-----------|--------|
| 1 | admin | 管理员 | 0（正常）|
| 2 | zhangsan | 张三 | 0（正常）|
| 3 | lisi | 李四 | 0（正常）|
| 4 | wangwu | 王五 | 1（停用）|
| 5 | zhaoliu | 赵六 | 0（正常）|

---

## ✅ 准备完成检查清单

完成以下检查，确保可以开始第3阶段：

- [ ] MySQL已安装并启动
- [ ] 可以使用root用户登录
- [ ] 数据库 hrone_db 已创建
- [ ] 表 sys_user 已创建
- [ ] 有5条测试数据
- [ ] application-dev.yml 配置正确
- [ ] 项目可以编译通过
- [ ] 项目可以启动（看到数据库连接日志）

**全部完成？** 开始第3阶段的学习！🚀

---

## 🎯 下一步

准备完成后：
1. 测试用户CRUD接口
2. 学习MyBatis-Plus的使用
3. 掌握分页查询
4. 理解条件构造器

**加油！** 💪

