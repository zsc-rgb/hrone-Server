# ğŸš€ ç¬¬3é˜¶æ®µå¿«é€Ÿå¼€å§‹æŒ‡å—

> æ•°æ®è®¿é—®å±‚ - MyBatis-Plus + Druid

---

## âœ… å·²å®Œæˆé…ç½®

### 3.1 æ•°æ®æºé…ç½® âœ…

**å·²é…ç½®ï¼š**
- âœ… Druidæ•°æ®æºï¼ˆè¿æ¥æ± ï¼‰
- âœ… MyBatis-Plusï¼ˆORMæ¡†æ¶ï¼‰
- âœ… åˆ†é¡µæ’ä»¶ï¼ˆPaginationInnerInterceptorï¼‰
- âœ… Druidç›‘æ§ï¼ˆè®¿é—® /druidï¼‰

**é…ç½®æ–‡ä»¶ï¼š**
- `application-dev.yml` - æ•°æ®æºå’ŒMyBatis-Plusé…ç½®
- `MybatisPlusConfig.java` - åˆ†é¡µæ’ä»¶é…ç½®

---

### 3.2 å®ä½“ç±»å’ŒMapper âœ…

**å·²åˆ›å»ºï¼š**
- âœ… SysUser - ç”¨æˆ·å®ä½“ç±»
- âœ… SysUserMapper - ç”¨æˆ·Mapperæ¥å£
- âœ… ISysUserService - ç”¨æˆ·Serviceæ¥å£
- âœ… SysUserServiceImpl - ç”¨æˆ·Serviceå®ç°ç±»
- âœ… SysUserController - ç”¨æˆ·Controller

**æ–‡ä»¶æ¸…å•ï¼š**
```
hrone-system/
â”œâ”€â”€ domain/
â”‚   â””â”€â”€ SysUser.java                  âœ… ç”¨æˆ·å®ä½“
â”œâ”€â”€ mapper/
â”‚   â””â”€â”€ SysUserMapper.java            âœ… ç”¨æˆ·Mapper
â””â”€â”€ service/
    â”œâ”€â”€ ISysUserService.java          âœ… Serviceæ¥å£
    â””â”€â”€ impl/
        â””â”€â”€ SysUserServiceImpl.java   âœ… Serviceå®ç°

hrone-admin/
â””â”€â”€ controller/
    â””â”€â”€ SysUserController.java        âœ… ç”¨æˆ·Controller

hrone-framework/
â””â”€â”€ config/
    â””â”€â”€ MybatisPlusConfig.java        âœ… MyBatis-Plusé…ç½®

sql/
â””â”€â”€ hrone_schema.sql                  âœ… æ•°æ®åº“è„šæœ¬
```

---

## âš ï¸ é‡è¦ï¼šå¯åŠ¨å‰å‡†å¤‡

### æ­¥éª¤1ï¼šå®‰è£…å¹¶å¯åŠ¨MySQL

**æ£€æŸ¥MySQLæ˜¯å¦å®‰è£…ï¼š**
```bash
mysql --version
```

**å¦‚æœæœªå®‰è£…ï¼Œè¯·æŸ¥çœ‹ï¼š** `ç¬¬3é˜¶æ®µ-å‡†å¤‡å·¥ä½œ.md`

---

### æ­¥éª¤2ï¼šåˆ›å»ºæ•°æ®åº“å’Œè¡¨

**æ–¹æ³•1ï¼šå‘½ä»¤è¡Œï¼ˆæ¨èï¼‰**
```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd d:\HroneWorking\hrone-Server

# æ‰§è¡ŒSQLè„šæœ¬
mysql -u root -p < sql/hrone_schema.sql
```

**æ–¹æ³•2ï¼šä½¿ç”¨Navicatç­‰å·¥å…·**
1. è¿æ¥MySQLï¼ˆlocalhost:3306ï¼Œç”¨æˆ·årootï¼‰
2. æ‰“å¼€å¹¶æ‰§è¡Œ `sql/hrone_schema.sql`
3. åˆ·æ–°ï¼Œåº”è¯¥çœ‹åˆ° `hrone_db` æ•°æ®åº“å’Œ `sys_user` è¡¨

---

### æ­¥éª¤3ï¼šä¿®æ”¹æ•°æ®åº“å¯†ç ï¼ˆå¦‚æœéœ€è¦ï¼‰

**å¦‚æœä½ çš„MySQLå¯†ç ä¸æ˜¯ `root`ï¼Œè¯·ä¿®æ”¹ï¼š**

æ–‡ä»¶ï¼š`hrone-admin/src/main/resources/application-dev.yml`

```yaml
spring:
  datasource:
    username: root     # ä½ çš„MySQLç”¨æˆ·å
    password: root     # ä½ çš„MySQLå¯†ç ï¼ˆä¿®æ”¹è¿™é‡Œï¼‰
```

---

### æ­¥éª¤4ï¼šéªŒè¯é…ç½®

**ç¼–è¯‘é¡¹ç›®ï¼š**
```bash
cd d:\HroneWorking\hrone-Server
mvn clean install -DskipTests
```

**é¢„æœŸï¼š** BUILD SUCCESS âœ…

---

## ğŸ§ª æµ‹è¯•æ¥å£

### ç”¨æˆ·ç®¡ç†æ¥å£ï¼ˆ9ä¸ªï¼‰

| åºå· | æ¥å£ | æ–¹æ³• | è¯´æ˜ |
|-----|------|------|------|
| 1 | `/system/user/list` | GET | æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨ |
| 2 | `/system/user/page` | GET | åˆ†é¡µæŸ¥è¯¢ç”¨æˆ· |
| 3 | `/system/user/{userId}` | GET | æ ¹æ®IDæŸ¥è¯¢ç”¨æˆ· |
| 4 | `/system/user/username/{userName}` | GET | æ ¹æ®ç”¨æˆ·åæŸ¥è¯¢ |
| 5 | `/system/user` | POST | æ–°å¢ç”¨æˆ· |
| 6 | `/system/user` | PUT | ä¿®æ”¹ç”¨æˆ· |
| 7 | `/system/user/{userId}` | DELETE | åˆ é™¤ç”¨æˆ· |
| 8 | `/system/user/batch` | DELETE | æ‰¹é‡åˆ é™¤ç”¨æˆ· |

---

### æµ‹è¯•ç¤ºä¾‹

#### 1. æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨

```
GET http://localhost:8080/system/user/list

å“åº”ï¼š
{
  "total": 5,
  "rows": [
    {
      "userId": 1,
      "userName": "admin",
      "nickName": "ç®¡ç†å‘˜",
      "email": "admin@hrone.com",
      "phone": "15888888888",
      ...
    }
  ],
  "code": 200,
  "msg": "æŸ¥è¯¢æˆåŠŸ"
}
```

#### 2. åˆ†é¡µæŸ¥è¯¢

```
GET http://localhost:8080/system/user/page?pageNum=1&pageSize=3

å“åº”ï¼š
{
  "code": 200,
  "msg": "æŸ¥è¯¢æˆåŠŸ",
  "total": 5,
  "pages": 2,
  "current": 1,
  "size": 3,
  "rows": [ ... 3æ¡æ•°æ® ... ]
}
```

#### 3. æ ¹æ®IDæŸ¥è¯¢

```
GET http://localhost:8080/system/user/1

å“åº”ï¼š
{
  "code": 200,
  "msg": "æ“ä½œæˆåŠŸ",
  "data": {
    "userId": 1,
    "userName": "admin",
    "nickName": "ç®¡ç†å‘˜",
    ...
  }
}
```

#### 4. æ–°å¢ç”¨æˆ·

```
POST http://localhost:8080/system/user
Content-Type: application/json

{
  "userName": "test001",
  "nickName": "æµ‹è¯•ç”¨æˆ·",
  "email": "test@hrone.com",
  "phone": "13800138000",
  "password": "123456"
}

å“åº”ï¼š
{
  "code": 200,
  "msg": "æ“ä½œæˆåŠŸ"
}
```

#### 5. ä¿®æ”¹ç”¨æˆ·

```
PUT http://localhost:8080/system/user
Content-Type: application/json

{
  "userId": 2,
  "nickName": "æ–°æ˜µç§°",
  "email": "newemail@hrone.com"
}

å“åº”ï¼š
{
  "code": 200,
  "msg": "æ“ä½œæˆåŠŸ"
}
```

#### 6. åˆ é™¤ç”¨æˆ·

```
DELETE http://localhost:8080/system/user/2

å“åº”ï¼š
{
  "code": 200,
  "msg": "æ“ä½œæˆåŠŸ"
}
```

---

## ğŸ” æ ¸å¿ƒçŸ¥è¯†ç‚¹

### 1. MyBatis-Plusçš„BaseMapper

**BaseMapperæä¾›çš„æ–¹æ³•ï¼š**
```java
// æ’å…¥
int insert(T entity);

// æ ¹æ®IDåˆ é™¤
int deleteById(Serializable id);

// æ ¹æ®IDæ›´æ–°
int updateById(T entity);

// æ ¹æ®IDæŸ¥è¯¢
T selectById(Serializable id);

// æŸ¥è¯¢åˆ—è¡¨
List<T> selectList(Wrapper<T> queryWrapper);

// åˆ†é¡µæŸ¥è¯¢
IPage<T> selectPage(IPage<T> page, Wrapper<T> queryWrapper);

// æŸ¥è¯¢æ€»æ•°
Long selectCount(Wrapper<T> queryWrapper);
```

**ä¸éœ€è¦å†™XMLï¼Œç›´æ¥è°ƒç”¨ï¼** ğŸ’ª

---

### 2. LambdaQueryWrapperï¼ˆæ¡ä»¶æ„é€ å™¨ï¼‰

**ç¤ºä¾‹ï¼š**
```java
LambdaQueryWrapper<SysUser> wrapper = new LambdaQueryWrapper<>();

// ç­‰äº
wrapper.eq(SysUser::getStatus, "0");

// æ¨¡ç³ŠæŸ¥è¯¢
wrapper.like(SysUser::getUserName, "å¼ ");

// æ’åº
wrapper.orderByDesc(SysUser::getCreateTime);

// å¤šæ¡ä»¶ç»„åˆ
wrapper.eq(SysUser::getStatus, "0")
       .like(SysUser::getUserName, "å¼ ")
       .orderByDesc(SysUser::getCreateTime);
```

**ä¼˜ç‚¹ï¼š**
- âœ… ç±»å‹å®‰å…¨ï¼ˆç¼–è¯‘æœŸæ£€æŸ¥ï¼‰
- âœ… é˜²æ­¢å­—æ®µåå†™é”™
- âœ… IDEè‡ªåŠ¨æç¤º

---

### 3. åˆ†é¡µæŸ¥è¯¢

**ä½¿ç”¨MyBatis-Plusçš„Pageï¼š**
```java
// åˆ›å»ºåˆ†é¡µå¯¹è±¡ï¼ˆå½“å‰é¡µï¼Œæ¯é¡µå¤§å°ï¼‰
Page<SysUser> page = new Page<>(1, 10);

// æ‰§è¡Œåˆ†é¡µæŸ¥è¯¢
IPage<SysUser> result = userService.page(page);

// è·å–åˆ†é¡µä¿¡æ¯
long total = result.getTotal();      // æ€»è®°å½•æ•°
List<SysUser> records = result.getRecords();  // æ•°æ®åˆ—è¡¨
long pages = result.getPages();       // æ€»é¡µæ•°
long current = result.getCurrent();   // å½“å‰é¡µç 
```

---

### 4. Serviceå±‚çš„æ‰¹é‡æ“ä½œ

**IServiceæä¾›çš„æ‰¹é‡æ–¹æ³•ï¼š**
```java
// æ‰¹é‡æ’å…¥
boolean saveBatch(Collection<T> entityList);

// æ‰¹é‡æ›´æ–°
boolean updateBatchById(Collection<T> entityList);

// æ‰¹é‡åˆ é™¤
boolean removeByIds(Collection<? extends Serializable> idList);
```

---

## ğŸ“Š æ•°æ®åº“ç›‘æ§

### Druidç›‘æ§é¢æ¿

**è®¿é—®åœ°å€ï¼š** http://localhost:8080/druid

**ç™»å½•ä¿¡æ¯ï¼š**
- ç”¨æˆ·åï¼šadmin
- å¯†ç ï¼šadmin123

**åŠŸèƒ½ï¼š**
- âœ… SQLç›‘æ§ï¼ˆæŸ¥çœ‹æ‰§è¡Œçš„SQLï¼‰
- âœ… æ€§èƒ½ç›‘æ§ï¼ˆæ…¢SQLç»Ÿè®¡ï¼‰
- âœ… è¿æ¥æ± ç›‘æ§ï¼ˆæ´»è·ƒè¿æ¥æ•°ï¼‰
- âœ… Webåº”ç”¨ç›‘æ§ï¼ˆURIè®¿é—®ç»Ÿè®¡ï¼‰

---

## âš¡ å¯åŠ¨é¡¹ç›®

### æ–¹æ³•1ï¼šä½¿ç”¨å¯åŠ¨è„šæœ¬

```bash
åŒå‡»ï¼šd:\HroneWorking\å¯åŠ¨åç«¯.bat
```

**å¯åŠ¨æˆåŠŸæ ‡å¿—ï¼š**
```
HikariPool-1 - Starting...
HikariPool-1 - Start completed.
========================================
   HROne åç«¯ç³»ç»Ÿå¯åŠ¨æˆåŠŸï¼
========================================
```

### æ–¹æ³•2ï¼šå‘½ä»¤è¡Œå¯åŠ¨

```bash
cd d:\HroneWorking\hrone-Server
mvn spring-boot:run -pl hrone-admin
```

---

## ğŸ†˜ å¸¸è§é—®é¢˜

### Q1: å¯åŠ¨æ—¶æŠ¥æ•°æ®åº“è¿æ¥å¤±è´¥ï¼Ÿ

**é”™è¯¯ï¼š** `Communications link failure`

**æ£€æŸ¥ï¼š**
1. MySQLæœåŠ¡æ˜¯å¦å¯åŠ¨ï¼š`net start mysql`
2. æ•°æ®åº“é…ç½®æ˜¯å¦æ­£ç¡®
3. é˜²ç«å¢™æ˜¯å¦é˜»æ­¢è¿æ¥

---

### Q2: æ‰¾ä¸åˆ°æ•°æ®åº“ hrone_dbï¼Ÿ

**é”™è¯¯ï¼š** `Unknown database 'hrone_db'`

**è§£å†³ï¼š**
```sql
mysql -u root -p < sql/hrone_schema.sql
```

---

### Q3: å¯†ç è®¤è¯å¤±è´¥ï¼Ÿ

**é”™è¯¯ï¼š** `Access denied for user 'root'`

**è§£å†³ï¼š**
1. æ£€æŸ¥ `application-dev.yml` ä¸­çš„å¯†ç 
2. ç¡®è®¤MySQLçš„rootå¯†ç 

---

##  âœ… å®Œæˆæ£€æŸ¥æ¸…å•

å¼€å§‹æµ‹è¯•å‰ï¼Œè¯·ç¡®è®¤ï¼š

### æ•°æ®åº“å‡†å¤‡ âœ…
- [ ] MySQLå·²å®‰è£…å¹¶å¯åŠ¨
- [ ] æ•°æ®åº“ `hrone_db` å·²åˆ›å»º
- [ ] è¡¨ `sys_user` å·²åˆ›å»º
- [ ] æœ‰5æ¡æµ‹è¯•æ•°æ®

### é¡¹ç›®é…ç½® âœ…
- [x] Druidä¾èµ–å·²æ·»åŠ 
- [x] MySQLé©±åŠ¨å·²æ·»åŠ 
- [x] application-dev.ymlå·²é…ç½®
- [x] MyBatis-Pluså·²é…ç½®
- [x] åˆ†é¡µæ’ä»¶å·²é…ç½®

### ä»£ç å®ç° âœ…
- [x] SysUserå®ä½“ç±»å·²åˆ›å»º
- [x] SysUserMapperå·²åˆ›å»º
- [x] SysUserServiceå·²åˆ›å»º
- [x] SysUserControllerå·²åˆ›å»º
- [x] é¡¹ç›®ç¼–è¯‘æˆåŠŸ

---

## ğŸ¯ ä¸‹ä¸€æ­¥

**å‡†å¤‡å·¥ä½œå®Œæˆåï¼š**
1. æŒ‰ç…§ `ç¬¬3é˜¶æ®µ-å‡†å¤‡å·¥ä½œ.md` åˆ›å»ºæ•°æ®åº“
2. å¯åŠ¨é¡¹ç›®
3. æµ‹è¯•ç”¨æˆ·ç®¡ç†æ¥å£
4. è®¿é—®Druidç›‘æ§é¢æ¿

**è¯¦ç»†æµ‹è¯•æ–‡æ¡£ï¼š** æŸ¥çœ‹ `ç¬¬3é˜¶æ®µ-æ•°æ®è®¿é—®æµ‹è¯•.md`ï¼ˆå³å°†åˆ›å»ºï¼‰

---

**ğŸ‰ ç¬¬3é˜¶æ®µä»£ç å·²å°±ç»ªï¼ç­‰å¾…æ•°æ®åº“å‡†å¤‡å®Œæˆå³å¯æµ‹è¯•ï¼** ğŸš€

